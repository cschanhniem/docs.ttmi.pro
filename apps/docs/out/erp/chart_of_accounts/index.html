<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/erp-docs/_next/static/media/e4af272ccee01ff0-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/erp-docs/_next/static/css/4b73dfd0f7bdc629.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/erp-docs/_next/static/chunks/webpack-39532e8569213db6.js"/><script src="/erp-docs/_next/static/chunks/7384d974-8b753aa07a0575a2.js" async=""></script><script src="/erp-docs/_next/static/chunks/381-1b6d0728bba7b8e7.js" async=""></script><script src="/erp-docs/_next/static/chunks/main-app-5d87a2fd0f4f2f33.js" async=""></script><script src="/erp-docs/_next/static/chunks/d550ec10-485e3f71f5def856.js" async=""></script><script src="/erp-docs/_next/static/chunks/993-1b6a71072be86da4.js" async=""></script><script src="/erp-docs/_next/static/chunks/410-1ece2fcedd156d2f.js" async=""></script><script src="/erp-docs/_next/static/chunks/app/%5B...slug%5D/page-7978846c0e32abf5.js" async=""></script><script src="/erp-docs/_next/static/chunks/app/layout-b6ef60bec0ff2cf2.js" async=""></script><title>undefined | ERP Documentation</title><meta name="keywords" content="documentation,ERP,technical,mermaid,markdown"/><meta name="next-size-adjust"/><script src="/erp-docs/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js" noModule=""></script></head><body class="__className_985585"><div class="min-h-screen flex items-center justify-center"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-primary"></div></div><script src="/erp-docs/_next/static/chunks/webpack-39532e8569213db6.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/erp-docs/_next/static/media/e4af272ccee01ff0-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n2:HL[\"/erp-docs/_next/static/css/4b73dfd0f7bdc629.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"3:I[5214,[],\"\"]\n5:I[3040,[\"135\",\"static/chunks/d550ec10-485e3f71f5def856.js\",\"993\",\"static/chunks/993-1b6a71072be86da4.js\",\"410\",\"static/chunks/410-1ece2fcedd156d2f.js\",\"877\",\"static/chunks/app/%5B...slug%5D/page-7978846c0e32abf5.js\"],\"DocLayout\"]\n6:I[1276,[\"135\",\"static/chunks/d550ec10-485e3f71f5def856.js\",\"993\",\"static/chunks/993-1b6a71072be86da4.js\",\"410\",\"static/chunks/410-1ece2fcedd156d2f.js\",\"877\",\"static/chunks/app/%5B...slug%5D/page-7978846c0e32abf5.js\"],\"MDXContent\"]\n8:I[6472,[],\"\"]\na:I[9190,[],\"\"]\nb:I[4550,[\"185\",\"static/chunks/app/layout-b6ef60bec0ff2cf2.js\"],\"ThemeProvider\"]\nc:I[8910,[\"185\",\"static/chunks/app/layout-b6ef60bec0ff2cf2.js\"],\"AuthProvider\"]\ne:I[3013,[],\"\"]\n7:T1262,"])</script><script>self.__next_f.push([1,"# Cơ Chế Tạo Hệ Thống Tài Khoản trong Django Ledger\n\n## Tổng Quan\n\nDjango Ledger sử dụng một hệ thống tài khoản linh hoạt, có thể tùy chỉnh dựa trên chuẩn kế toán Việt Nam (TT200). Tài liệu này mô tả chi tiết cơ chế hoạt động và luồng xử lý của hệ thống.\n\n## Sơ Đồ Luồng Xử Lý\n\n```mermaid\ngraph TD\n    A[Khởi tạo Entity] --\u003e|Tạo mới| B[ChartOfAccountModel]\n    B --\u003e|Kiểm tra| C{Có DJANGO_LEDGER_DEFAULT_COA?}\n    C --\u003e|Có| D[Sử dụng COA từ Settings]\n    C --\u003e|Không| E[Sử dụng DEFAULT_CHART_OF_ACCOUNTS]\n    D --\u003e F[Khởi tạo Root Nodes]\n    E --\u003e F\n    F --\u003e|Tạo| G[ROOT_COA]\n    F --\u003e|Tạo| H[ROOT_ASSETS]\n    F --\u003e|Tạo| I[ROOT_LIABILITIES]\n    F --\u003e|Tạo| J[ROOT_CAPITAL]\n    F --\u003e|Tạo| K[ROOT_INCOME]\n    F --\u003e|Tạo| L[ROOT_EXPENSES]\n    G --\u003e M[Thiết lập quan hệ cha-con]\n```\n\n## Cấu Trúc Hệ Thống\n\n### 1. Mô Hình Dữ Liệu Chính\n\n#### ChartOfAccountModel\n- UUID: Định danh duy nhất\n- Entity: Liên kết với đơn vị kế toán\n- Name: Tên hệ thống tài khoản\n- Slug: Định danh URL\n- Active: Trạng thái hoạt động\n\n#### AccountModel\n- UUID: Định danh duy nhất\n- Code: Mã tài khoản (ví dụ: 111, 112)\n- Name: Tên tài khoản\n- Role: Vai trò (ví dụ: ASSET_CA_CASH)\n- Balance_type: Loại số dư (Debit/Credit)\n- Parent: Tài khoản cha\n\n### 2. Quy Trình Khởi Tạo\n\n#### 2.1. Khởi Tạo Ban Đầu\n```python\nDEFAULT_CHART_OF_ACCOUNTS = [\n    {'code': '111', 'role': 'ASSET_CA_CASH', 'name': 'Tiền mặt', ...},\n    {'code': '112', 'role': 'ASSET_CA_CASH', 'name': 'Tiền gửi ngân hàng', ...},\n    # ...\n]\n```\n\n#### 2.2. Cấu Hình Qua Settings\n```python\nDJANGO_LEDGER_DEFAULT_COA = [\n    # Cấu hình tùy chỉnh\n]\n```\n\n### 3. Endpoints và Views\n\n#### 3.1. Tạo Mới Chart of Accounts\n- URL: `/entity/\u003cslug:entity_slug\u003e/coa/create/`\n- View: `ChartOfAccountsCreateView`\n- Method: POST\n- Quyền truy cập: Entity Admin/Manager\n\n#### 3.2. Danh Sách Chart of Accounts\n- URL: `/entity/\u003cslug:entity_slug\u003e/coa/list/`\n- View: `ChartOfAccountsListView`\n- Method: GET\n- Quyền truy cập: Entity Admin/Manager\n\n#### 3.3. Chi Tiết Chart of Accounts\n- URL: `/entity/\u003cslug:entity_slug\u003e/coa/\u003cslug:coa_slug\u003e/detail/`\n- View: `ChartOfAccountsDetailView`\n- Method: GET\n- Quyền truy cập: Entity Admin/Manager\n\n## Hệ Thống Vai Trò (Roles)\n\n### 1. Nhóm Tài Sản\n- ASSET_CA_CASH: Tiền mặt\n- ASSET_CA_RECEIVABLES: Phải thu\n- ASSET_PPE_BUILDINGS: Tài sản cố định\n\n### 2. Nhóm Nợ Phải Trả\n- LIABILITY_CL_ACC_PAYABLE: Phải trả người bán\n- LIABILITY_CL_WAGES_PAYABLE: Phải trả người lao động\n\n### 3. Nhóm Vốn Chủ Sở Hữu\n- EQUITY_CAPITAL: Vốn góp\n- EQUITY_COMMON_STOCK: Cổ phiếu phổ thông\n\n## Quy Trình Sử Dụng\n\n### 1. Tạo Entity Mới\n```python\nfrom django_ledger.models import EntityModel\n\nentity = EntityModel.objects.create(\n    name='Công ty ABC',\n    admin=user_model\n)\n```\n\n### 2. Khởi Tạo Chart of Accounts\n```python\nfrom django_ledger.models import ChartOfAccountModel\n\ncoa = ChartOfAccountModel.objects.create(\n    name='Hệ thống tài khoản chuẩn',\n    entity=entity\n)\ncoa.configure()  # Thiết lập cấu trúc cây tài khoản\n```\n\n### 3. Thêm Tài Khoản Mới\n```python\ncoa.create_account(\n    code='1111',\n    role='ASSET_CA_CASH',\n    name='Tiền mặt VND',\n    balance_type='debit',\n    active=True\n)\n```\n\n## Xử Lý Đặc Biệt\n\n### 1. Tự Động Tạo Root Nodes\n- Hệ thống tự động tạo các node gốc khi configure()\n- Các node gốc không thể xóa hoặc sửa đổi\n\n### 2. Kiểm Tra Tính Hợp Lệ\n- Kiểm tra mã tài khoản trùng lặp\n- Kiểm tra quan hệ cha-con hợp lệ\n- Kiểm tra balance type phù hợp với role\n\n## Best Practices\n\n1. **Tổ Chức Mã Tài Khoản**\n   - Sử dụng tiền tố rõ ràng\n   - Giữ độ dài nhất quán\n   - Đánh số theo logic phân cấp\n\n2. **Quản Lý Roles**\n   - Định nghĩa roles mới qua settings\n   - Kiểm tra tính hợp lệ của roles\n   - Tài liệu hóa roles mới\n\n3. **Bảo Mật**\n   - Kiểm soát quyền truy cập\n   - Ghi log thay đổi\n   - Backup định kỳ\n\n4. **Hiệu Suất**\n   - Cache danh sách tài khoản\n   - Tối ưu truy vấn\n   - Phân trang kết quả\n\n## Tham Khảo\n\n1. [Django Ledger Documentation](https://django-ledger.readthedocs.io/)\n2. [Thông tư 200/2014/TT-BTC](https://thuvienphapluat.vn/van-ban/Ke-toan-Kiem-toan/Thong-tu-200-2014-TT-BTC-huong-dan-Che-do-ke-toan-Doanh-nghiep-263599.aspx)\n3. [Django Documentation](https://docs.djangoproject.com/)\n"])</script><script>self.__next_f.push([1,"9:[\"slug\",\"erp/chart_of_accounts\",\"c\"]\nf:[]\n"])</script><script>self.__next_f.push([1,"0:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/erp-docs/_next/static/css/4b73dfd0f7bdc629.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]],[\"$\",\"$L3\",null,{\"buildId\":\"X5KF-BjlTdL2YCafX7ACW\",\"assetPrefix\":\"/erp-docs\",\"initialCanonicalUrl\":\"/erp/chart_of_accounts/\",\"initialTree\":[\"\",{\"children\":[[\"slug\",\"erp/chart_of_accounts\",\"c\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":[\\\"erp\\\",\\\"chart_of_accounts\\\"]}\",{}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[[\"slug\",\"erp/chart_of_accounts\",\"c\"],{\"children\":[\"__PAGE__\",{},[[\"$L4\",[\"$\",\"$L5\",null,{\"children\":[\"$\",\"article\",null,{\"className\":\"prose prose-slate dark:prose-invert max-w-none\",\"children\":[[\"$\",\"header\",null,{\"className\":\"mb-8\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"mb-2\",\"children\":\"$undefined\"}],\"$undefined\",\"$undefined\"]}],[\"$\",\"$L6\",null,{\"content\":\"$7\"}]]}]}]],null],null]},[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"$9\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}],null]},[[\"$\",\"html\",null,{\"lang\":\"en\",\"suppressHydrationWarning\":true,\"children\":[\"$\",\"body\",null,{\"className\":\"__className_985585\",\"children\":[\"$\",\"$Lb\",null,{\"attribute\":\"class\",\"defaultTheme\":\"system\",\"enableSystem\":true,\"disableTransitionOnChange\":true,\"children\":[\"$\",\"$Lc\",null,{\"children\":[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[],\"styles\":null}]}]}]}]}],null],null],\"couldBeIntercepted\":false,\"initialHead\":[false,\"$Ld\"],\"globalErrorComponent\":\"$e\",\"missingSlots\":\"$Wf\"}]]\n"])</script><script>self.__next_f.push([1,"d:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"undefined | ERP Documentation\"}],[\"$\",\"meta\",\"3\",{\"name\":\"keywords\",\"content\":\"documentation,ERP,technical,mermaid,markdown\"}],[\"$\",\"meta\",\"4\",{\"name\":\"next-size-adjust\"}]]\n4:null\n"])</script></body></html>