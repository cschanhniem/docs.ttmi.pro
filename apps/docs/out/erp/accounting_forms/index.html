<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/erp-docs/_next/static/media/e4af272ccee01ff0-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/erp-docs/_next/static/css/4b73dfd0f7bdc629.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/erp-docs/_next/static/chunks/webpack-39532e8569213db6.js"/><script src="/erp-docs/_next/static/chunks/7384d974-8b753aa07a0575a2.js" async=""></script><script src="/erp-docs/_next/static/chunks/381-1b6d0728bba7b8e7.js" async=""></script><script src="/erp-docs/_next/static/chunks/main-app-5d87a2fd0f4f2f33.js" async=""></script><script src="/erp-docs/_next/static/chunks/d550ec10-485e3f71f5def856.js" async=""></script><script src="/erp-docs/_next/static/chunks/993-1b6a71072be86da4.js" async=""></script><script src="/erp-docs/_next/static/chunks/410-1ece2fcedd156d2f.js" async=""></script><script src="/erp-docs/_next/static/chunks/app/%5B...slug%5D/page-7978846c0e32abf5.js" async=""></script><script src="/erp-docs/_next/static/chunks/app/layout-b6ef60bec0ff2cf2.js" async=""></script><title>undefined | ERP Documentation</title><meta name="keywords" content="documentation,ERP,technical,mermaid,markdown"/><meta name="next-size-adjust"/><script src="/erp-docs/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js" noModule=""></script></head><body class="__className_985585"><div class="min-h-screen flex items-center justify-center"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-primary"></div></div><script src="/erp-docs/_next/static/chunks/webpack-39532e8569213db6.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/erp-docs/_next/static/media/e4af272ccee01ff0-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n2:HL[\"/erp-docs/_next/static/css/4b73dfd0f7bdc629.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"3:I[5214,[],\"\"]\n5:I[3040,[\"135\",\"static/chunks/d550ec10-485e3f71f5def856.js\",\"993\",\"static/chunks/993-1b6a71072be86da4.js\",\"410\",\"static/chunks/410-1ece2fcedd156d2f.js\",\"877\",\"static/chunks/app/%5B...slug%5D/page-7978846c0e32abf5.js\"],\"DocLayout\"]\n6:I[1276,[\"135\",\"static/chunks/d550ec10-485e3f71f5def856.js\",\"993\",\"static/chunks/993-1b6a71072be86da4.js\",\"410\",\"static/chunks/410-1ece2fcedd156d2f.js\",\"877\",\"static/chunks/app/%5B...slug%5D/page-7978846c0e32abf5.js\"],\"MDXContent\"]\n8:I[6472,[],\"\"]\na:I[9190,[],\"\"]\nb:I[4550,[\"185\",\"static/chunks/app/layout-b6ef60bec0ff2cf2.js\"],\"ThemeProvider\"]\nc:I[8910,[\"185\",\"static/chunks/app/layout-b6ef60bec0ff2cf2.js\"],\"AuthProvider\"]\ne:I[3013,[],\"\"]\n7:T359c,"])</script><script>self.__next_f.push([1,"# Hướng Dẫn Mẫu Biểu và Sổ Sách Kế Toán Theo TT200\n\n## 1. Chứng Từ Kế Toán\n\n### 1.1. Phiếu Thu (Mẫu 01-TT)\n```python\ndef tao_phieu_thu(entity_model, data):\n    \"\"\"\n    Tạo phiếu thu tiền mặt\n    \"\"\"\n    phieu_thu = {\n        'so_chung_tu': generate_document_number('PT'),\n        'ngay_chung_tu': data['ngay_chung_tu'],\n        'doi_tuong_nop': data['doi_tuong_nop'],\n        'dia_chi': data['dia_chi'],\n        'ly_do_nop': data['ly_do_nop'],\n        'so_tien': data['so_tien'],\n        'bang_chu': convert_number_to_words(data['so_tien']),\n        'kem_theo': data.get('kem_theo', ''),\n        'but_toan': [\n            {\n                'tai_khoan_no': '111',\n                'tai_khoan_co': data['tai_khoan_doi_ung'],\n                'so_tien': data['so_tien']\n            }\n        ]\n    }\n    \n    # Tạo bút toán\n    je = create_journal_entry(entity_model, phieu_thu['but_toan'])\n    \n    # Lưu chứng từ\n    save_document(entity_model, 'phieu_thu', phieu_thu, je.uuid)\n    \n    return phieu_thu\n```\n\n### 1.2. Phiếu Chi (Mẫu 02-TT)\n```python\ndef tao_phieu_chi(entity_model, data):\n    \"\"\"\n    Tạo phiếu chi tiền mặt\n    \"\"\"\n    phieu_chi = {\n        'so_chung_tu': generate_document_number('PC'),\n        'ngay_chung_tu': data['ngay_chung_tu'],\n        'nguoi_nhan': data['nguoi_nhan'],\n        'dia_chi': data['dia_chi'],\n        'ly_do_chi': data['ly_do_chi'],\n        'so_tien': data['so_tien'],\n        'bang_chu': convert_number_to_words(data['so_tien']),\n        'kem_theo': data.get('kem_theo', ''),\n        'but_toan': [\n            {\n                'tai_khoan_no': data['tai_khoan_doi_ung'],\n                'tai_khoan_co': '111',\n                'so_tien': data['so_tien']\n            }\n        ]\n    }\n    \n    # Tạo bút toán\n    je = create_journal_entry(entity_model, phieu_chi['but_toan'])\n    \n    # Lưu chứng từ\n    save_document(entity_model, 'phieu_chi', phieu_chi, je.uuid)\n    \n    return phieu_chi\n```\n\n## 2. Sổ Kế Toán Chi Tiết\n\n### 2.1. Sổ Quỹ Tiền Mặt (Mẫu S07-DN)\n```python\ndef in_so_quy_tien_mat(entity_model, start_date, end_date):\n    \"\"\"\n    In sổ quỹ tiền mặt\n    \"\"\"\n    # Lấy số dư đầu kỳ\n    so_du_dk = get_opening_balance(entity_model, '111', start_date)\n    \n    # Lấy các giao dịch trong kỳ\n    transactions = TransactionModel.objects.filter(\n        journal_entry__ledger__entity=entity_model,\n        account_id='111',\n        journal_entry__date__range=[start_date, end_date]\n    ).order_by('journal_entry__date', 'journal_entry__id')\n    \n    entries = []\n    total_debit = Decimal('0')\n    total_credit = Decimal('0')\n    balance = so_du_dk\n    \n    for tx in transactions:\n        if tx.tx_type == 'debit':\n            balance += tx.amount\n            total_debit += tx.amount\n        else:\n            balance -= tx.amount\n            total_credit += tx.amount\n            \n        entries.append({\n            'ngay_chung_tu': tx.journal_entry.date,\n            'so_chung_tu': tx.journal_entry.je_number,\n            'dien_giai': tx.journal_entry.description,\n            'thu': tx.amount if tx.tx_type == 'debit' else 0,\n            'chi': tx.amount if tx.tx_type == 'credit' else 0,\n            'ton': balance\n        })\n    \n    return {\n        'so_du_dau_ky': so_du_dk,\n        'entries': entries,\n        'tong_thu': total_debit,\n        'tong_chi': total_credit,\n        'so_du_cuoi_ky': balance\n    }\n```\n\n### 2.2. Sổ Kế Toán Chi Tiết Vật Tư (S12-DN)\n```python\ndef in_so_chi_tiet_vat_tu(entity_model, material_code, start_date, end_date):\n    \"\"\"\n    In sổ chi tiết vật tư, hàng hóa\n    \"\"\"\n    # Lấy số dư đầu kỳ\n    so_du_dk = get_inventory_opening_balance(\n        entity_model,\n        material_code,\n        start_date\n    )\n    \n    # Lấy các giao dịch trong kỳ\n    transactions = InventoryTransactionModel.objects.filter(\n        entity=entity_model,\n        material_code=material_code,\n        date__range=[start_date, end_date]\n    ).order_by('date')\n    \n    entries = []\n    total_in = Decimal('0')\n    total_out = Decimal('0')\n    quantity = so_du_dk['quantity']\n    value = so_du_dk['value']\n    \n    for tx in transactions:\n        if tx.transaction_type == 'in':\n            quantity += tx.quantity\n            value += tx.value\n            total_in += tx.quantity\n        else:\n            quantity -= tx.quantity\n            value -= tx.value\n            total_out += tx.quantity\n            \n        entries.append({\n            'ngay_chung_tu': tx.date,\n            'so_chung_tu': tx.document_number,\n            'dien_giai': tx.description,\n            'nhap_so_luong': tx.quantity if tx.transaction_type == 'in' else 0,\n            'nhap_don_gia': tx.unit_price if tx.transaction_type == 'in' else 0,\n            'nhap_thanh_tien': tx.value if tx.transaction_type == 'in' else 0,\n            'xuat_so_luong': tx.quantity if tx.transaction_type == 'out' else 0,\n            'xuat_don_gia': tx.unit_price if tx.transaction_type == 'out' else 0,\n            'xuat_thanh_tien': tx.value if tx.transaction_type == 'out' else 0,\n            'ton_so_luong': quantity,\n            'ton_thanh_tien': value\n        })\n    \n    return {\n        'so_du_dau_ky': so_du_dk,\n        'entries': entries,\n        'tong_nhap': {'so_luong': total_in},\n        'tong_xuat': {'so_luong': total_out},\n        'ton_cuoi_ky': {\n            'so_luong': quantity,\n            'gia_tri': value\n        }\n    }\n```\n\n## 3. Sổ Kế Toán Tổng Hợp\n\n### 3.1. Sổ Nhật Ký Chung (Mẫu S01-DN)\n```python\ndef in_so_nhat_ky_chung(entity_model, start_date, end_date):\n    \"\"\"\n    In sổ nhật ký chung\n    \"\"\"\n    entries = JournalEntryModel.objects.filter(\n        ledger__entity=entity_model,\n        date__range=[start_date, end_date]\n    ).prefetch_related('transactionmodel_set')\n    \n    so_nhat_ky = []\n    page = 1\n    total_debit = Decimal('0')\n    total_credit = Decimal('0')\n    \n    for je in entries:\n        transactions = je.transactionmodel_set.all()\n        \n        for tx in transactions:\n            if tx.tx_type == 'debit':\n                total_debit += tx.amount\n            else:\n                total_credit += tx.amount\n                \n            so_nhat_ky.append({\n                'ngay_chung_tu': je.date,\n                'so_chung_tu': je.je_number,\n                'dien_giai': je.description,\n                'tai_khoan_no': tx.account_id if tx.tx_type == 'debit' else '',\n                'tai_khoan_co': tx.account_id if tx.tx_type == 'credit' else '',\n                'so_tien': tx.amount,\n                'trang_so': page\n            })\n            \n        if len(so_nhat_ky) \u003e= 30:  # 30 dòng mỗi trang\n            page += 1\n    \n    return {\n        'entries': so_nhat_ky,\n        'tong_phat_sinh': {\n            'no': total_debit,\n            'co': total_credit\n        },\n        'so_trang': page\n    }\n```\n\n### 3.2. Sổ Cái (Mẫu S02-DN)\n```python\ndef in_so_cai(entity_model, account_id, start_date, end_date):\n    \"\"\"\n    In sổ cái các tài khoản\n    \"\"\"\n    # Lấy số dư đầu kỳ\n    so_du_dk = get_opening_balance(entity_model, account_id, start_date)\n    \n    # Lấy các phát sinh trong kỳ\n    transactions = TransactionModel.objects.filter(\n        journal_entry__ledger__entity=entity_model,\n        account_id=account_id,\n        journal_entry__date__range=[start_date, end_date]\n    ).order_by('journal_entry__date', 'journal_entry__id')\n    \n    entries = []\n    total_debit = Decimal('0')\n    total_credit = Decimal('0')\n    balance = so_du_dk\n    \n    for tx in transactions:\n        if tx.tx_type == 'debit':\n            balance += tx.amount\n            total_debit += tx.amount\n        else:\n            balance -= tx.amount\n            total_credit += tx.amount\n            \n        entries.append({\n            'ngay_chung_tu': tx.journal_entry.date,\n            'so_chung_tu': tx.journal_entry.je_number,\n            'dien_giai': tx.journal_entry.description,\n            'tai_khoan_doi_ung': get_corresponding_account(tx),\n            'phat_sinh_no': tx.amount if tx.tx_type == 'debit' else 0,\n            'phat_sinh_co': tx.amount if tx.tx_type == 'credit' else 0,\n            'so_du': balance\n        })\n    \n    return {\n        'so_du_dau_ky': so_du_dk,\n        'entries': entries,\n        'tong_phat_sinh': {\n            'no': total_debit,\n            'co': total_credit\n        },\n        'so_du_cuoi_ky': balance\n    }\n```\n\n## 4. Thuyết Minh Báo Cáo Tài Chính\n\n### 4.1. Thuyết Minh Tài Sản Cố Định (Mẫu B09-DN)\n```python\ndef thuyet_minh_tscd(entity_model, report_date):\n    \"\"\"\n    Thuyết minh tăng giảm TSCĐ\n    \"\"\"\n    return {\n        'nguyen_gia': {\n            'so_dau_nam': get_fixed_assets_cost(entity_model, start_of_year(report_date)),\n            'tang_trong_ky': get_fixed_assets_additions(entity_model, report_date),\n            'giam_trong_ky': get_fixed_assets_disposals(entity_model, report_date),\n            'so_cuoi_ky': get_fixed_assets_cost(entity_model, report_date)\n        },\n        'hao_mon': {\n            'so_dau_nam': get_accumulated_depreciation(entity_model, start_of_year(report_date)),\n            'khau_hao': get_depreciation_expense(entity_model, report_date),\n            'giam_khac': get_depreciation_disposals(entity_model, report_date),\n            'so_cuoi_ky': get_accumulated_depreciation(entity_model, report_date)\n        },\n        'gia_tri_con_lai': {\n            'so_dau_nam': get_net_book_value(entity_model, start_of_year(report_date)),\n            'so_cuoi_ky': get_net_book_value(entity_model, report_date)\n        }\n    }\n```\n\n### 4.2. Thuyết Minh Vay và Nợ (Mẫu B09-DN)\n```python\ndef thuyet_minh_vay_no(entity_model, report_date):\n    \"\"\"\n    Thuyết minh các khoản vay\n    \"\"\"\n    return {\n        'vay_ngan_han': {\n            'so_dau_nam': get_loan_balance(entity_model, 'short_term', start_of_year(report_date)),\n            'tang_trong_ky': get_loan_additions(entity_model, 'short_term', report_date),\n            'giam_trong_ky': get_loan_payments(entity_model, 'short_term', report_date),\n            'so_cuoi_ky': get_loan_balance(entity_model, 'short_term', report_date)\n        },\n        'vay_dai_han': {\n            'so_dau_nam': get_loan_balance(entity_model, 'long_term', start_of_year(report_date)),\n            'tang_trong_ky': get_loan_additions(entity_model, 'long_term', report_date),\n            'giam_trong_ky': get_loan_payments(entity_model, 'long_term', report_date),\n            'so_cuoi_ky': get_loan_balance(entity_model, 'long_term', report_date)\n        }\n    }\n```\n\n## 5. Xuất Báo Cáo\n\n### 5.1. Xuất File Excel\n```python\ndef xuat_bao_cao_excel(report_type, data):\n    \"\"\"\n    Xuất báo cáo ra file Excel theo mẫu\n    \"\"\"\n    import openpyxl\n    from openpyxl.styles import Alignment, Font, Border, Side\n    \n    # Tải template tương ứng\n    wb = openpyxl.load_workbook(f'templates/{report_type}.xlsx')\n    ws = wb.active\n    \n    # Điền dữ liệu vào template\n    fill_template(ws, data)\n    \n    # Định dạng báo cáo\n    format_report(ws)\n    \n    # Lưu file\n    output = BytesIO()\n    wb.save(output)\n    return output.getvalue()\n```\n\n### 5.2. Xuất File PDF\n```python\ndef xuat_bao_cao_pdf(report_type, data):\n    \"\"\"\n    Xuất báo cáo ra file PDF theo mẫu\n    \"\"\"\n    from weasyprint import HTML, CSS\n    \n    # Tạo HTML từ template\n    template = get_template(f'reports/{report_type}.html')\n    html_string = template.render(data)\n    \n    # Tạo PDF\n    html = HTML(string=html_string)\n    css = CSS(string='''\n        @page {\n            size: A4;\n            margin: 2cm;\n        }\n        .header {\n            text-align: center;\n            font-weight: bold;\n        }\n        .table {\n            width: 100%;\n            border-collapse: collapse;\n        }\n        .table td, .table th {\n            border: 1px solid black;\n            padding: 5px;\n        }\n    ''')\n    \n    return html.write_pdf(stylesheets=[css])\n```\n\n## 6. Tiện Ích Hỗ Trợ\n\n### 6.1. Tạo Số Chứng Từ\n```python\ndef generate_document_number(prefix, entity_model=None):\n    \"\"\"\n    Tạo số chứng từ tự động\n    \"\"\"\n    if entity_model:\n        last_number = get_last_document_number(entity_model, prefix)\n        next_number = int(last_number[len(prefix):]) + 1 if last_number else 1\n    else:\n        next_number = 1\n        \n    return f\"{prefix}{next_number:06d}\"\n```\n\n### 6.2. Chuyển Số Thành Chữ\n```python\ndef convert_number_to_words(number):\n    \"\"\"\n    Chuyển số thành chữ tiếng Việt\n    \"\"\"\n    units = [\"\", \"một\", \"hai\", \"ba\", \"bốn\", \"năm\", \"sáu\", \"bảy\", \"tám\", \"chín\"]\n    thousands = [\"\", \"nghìn\", \"triệu\", \"tỷ\"]\n    \n    def read_group(n):\n        hundreds = n // 100\n        tens = (n % 100) // 10\n        ones = n % 10\n        \n        result = []\n        if hundreds:\n            result.extend([units[hundreds], \"trăm\"])\n        if tens:\n            if tens == 1:\n                result.append(\"mười\")\n            else:\n                result.extend([units[tens], \"mươi\"])\n        if ones:\n            result.append(units[ones])\n            \n        return \" \".join(result)\n    \n    if number == 0:\n        return \"không\"\n        \n    groups = []\n    num = abs(number)\n    while num:\n        groups.append(num % 1000)\n        num //= 1000\n        \n    result = []\n    for i, group in enumerate(groups):\n        if group:\n            result.insert(0, read_group(group))\n            if i \u003c len(thousands):\n                result.insert(1, thousands[i])\n                \n    return \" \".join(result) + \" đồng\"\n"])</script><script>self.__next_f.push([1,"9:[\"slug\",\"erp/accounting_forms\",\"c\"]\nf:[]\n"])</script><script>self.__next_f.push([1,"0:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/erp-docs/_next/static/css/4b73dfd0f7bdc629.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]],[\"$\",\"$L3\",null,{\"buildId\":\"X5KF-BjlTdL2YCafX7ACW\",\"assetPrefix\":\"/erp-docs\",\"initialCanonicalUrl\":\"/erp/accounting_forms/\",\"initialTree\":[\"\",{\"children\":[[\"slug\",\"erp/accounting_forms\",\"c\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":[\\\"erp\\\",\\\"accounting_forms\\\"]}\",{}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[[\"slug\",\"erp/accounting_forms\",\"c\"],{\"children\":[\"__PAGE__\",{},[[\"$L4\",[\"$\",\"$L5\",null,{\"children\":[\"$\",\"article\",null,{\"className\":\"prose prose-slate dark:prose-invert max-w-none\",\"children\":[[\"$\",\"header\",null,{\"className\":\"mb-8\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"mb-2\",\"children\":\"$undefined\"}],\"$undefined\",\"$undefined\"]}],[\"$\",\"$L6\",null,{\"content\":\"$7\"}]]}]}]],null],null]},[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"$9\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}],null]},[[\"$\",\"html\",null,{\"lang\":\"en\",\"suppressHydrationWarning\":true,\"children\":[\"$\",\"body\",null,{\"className\":\"__className_985585\",\"children\":[\"$\",\"$Lb\",null,{\"attribute\":\"class\",\"defaultTheme\":\"system\",\"enableSystem\":true,\"disableTransitionOnChange\":true,\"children\":[\"$\",\"$Lc\",null,{\"children\":[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[],\"styles\":null}]}]}]}]}],null],null],\"couldBeIntercepted\":false,\"initialHead\":[false,\"$Ld\"],\"globalErrorComponent\":\"$e\",\"missingSlots\":\"$Wf\"}]]\n"])</script><script>self.__next_f.push([1,"d:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"undefined | ERP Documentation\"}],[\"$\",\"meta\",\"3\",{\"name\":\"keywords\",\"content\":\"documentation,ERP,technical,mermaid,markdown\"}],[\"$\",\"meta\",\"4\",{\"name\":\"next-size-adjust\"}]]\n4:null\n"])</script></body></html>