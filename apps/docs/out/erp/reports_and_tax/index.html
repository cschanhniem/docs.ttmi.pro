<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/erp-docs/_next/static/media/e4af272ccee01ff0-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/erp-docs/_next/static/css/4b73dfd0f7bdc629.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/erp-docs/_next/static/chunks/webpack-39532e8569213db6.js"/><script src="/erp-docs/_next/static/chunks/7384d974-8b753aa07a0575a2.js" async=""></script><script src="/erp-docs/_next/static/chunks/381-1b6d0728bba7b8e7.js" async=""></script><script src="/erp-docs/_next/static/chunks/main-app-5d87a2fd0f4f2f33.js" async=""></script><script src="/erp-docs/_next/static/chunks/d550ec10-485e3f71f5def856.js" async=""></script><script src="/erp-docs/_next/static/chunks/993-1b6a71072be86da4.js" async=""></script><script src="/erp-docs/_next/static/chunks/410-1ece2fcedd156d2f.js" async=""></script><script src="/erp-docs/_next/static/chunks/app/%5B...slug%5D/page-7978846c0e32abf5.js" async=""></script><script src="/erp-docs/_next/static/chunks/app/layout-b6ef60bec0ff2cf2.js" async=""></script><title>undefined | ERP Documentation</title><meta name="keywords" content="documentation,ERP,technical,mermaid,markdown"/><meta name="next-size-adjust"/><script src="/erp-docs/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js" noModule=""></script></head><body class="__className_985585"><div class="min-h-screen flex items-center justify-center"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-primary"></div></div><script src="/erp-docs/_next/static/chunks/webpack-39532e8569213db6.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/erp-docs/_next/static/media/e4af272ccee01ff0-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n2:HL[\"/erp-docs/_next/static/css/4b73dfd0f7bdc629.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"3:I[5214,[],\"\"]\n5:I[3040,[\"135\",\"static/chunks/d550ec10-485e3f71f5def856.js\",\"993\",\"static/chunks/993-1b6a71072be86da4.js\",\"410\",\"static/chunks/410-1ece2fcedd156d2f.js\",\"877\",\"static/chunks/app/%5B...slug%5D/page-7978846c0e32abf5.js\"],\"DocLayout\"]\n6:I[1276,[\"135\",\"static/chunks/d550ec10-485e3f71f5def856.js\",\"993\",\"static/chunks/993-1b6a71072be86da4.js\",\"410\",\"static/chunks/410-1ece2fcedd156d2f.js\",\"877\",\"static/chunks/app/%5B...slug%5D/page-7978846c0e32abf5.js\"],\"MDXContent\"]\n8:I[6472,[],\"\"]\na:I[9190,[],\"\"]\nb:I[4550,[\"185\",\"static/chunks/app/layout-b6ef60bec0ff2cf2.js\"],\"ThemeProvider\"]\nc:I[8910,[\"185\",\"static/chunks/app/layout-b6ef60bec0ff2cf2.js\"],\"AuthProvider\"]\ne:I[3013,[],\"\"]\n7:T31b0,"])</script><script>self.__next_f.push([1,"# Hướng Dẫn Báo Cáo Tài Chính và Thuế\n\n## 1. Các Loại Báo Cáo Tài Chính\n\n### 1.1. Bảng Cân Đối Kế Toán (Mẫu B01-DN)\n```python\nfrom django_ledger.io.io_generator import BalanceSheetGenerator\n\ndef xuat_bang_can_doi_ke_toan(entity_model, report_date):\n    \"\"\"\n    Xuất bảng cân đối kế toán theo mẫu B01-DN\n    \"\"\"\n    generator = BalanceSheetGenerator(\n        entity_slug=entity_model.slug,\n        to_date=report_date\n    )\n    \n    data = generator.get_balance_sheet_data()\n    \n    return {\n        'tai_san': {\n            'tai_san_ngan_han': {\n                'tien': data.get_account_balance(['111', '112']),\n                'dau_tu_tc_ngan_han': data.get_account_balance(['121', '128']),\n                'phai_thu': data.get_account_balance(['131', '136', '138']),\n                'hang_ton_kho': data.get_account_balance(['151', '152', '153', '155', '156']),\n            },\n            'tai_san_dai_han': {\n                'tai_san_co_dinh': data.get_account_balance(['211', '213']) - \n                                 data.get_account_balance(['214']),\n                'bat_dong_san_dau_tu': data.get_account_balance(['217']),\n                'tai_san_do_dang': data.get_account_balance(['241']),\n            }\n        },\n        'nguon_von': {\n            'no_phai_tra': {\n                'no_ngan_han': data.get_account_balance(['311', '331', '333', '334']),\n                'no_dai_han': data.get_account_balance(['341', '343']),\n            },\n            'von_chu_so_huu': {\n                'von_gop': data.get_account_balance(['411']),\n                'loi_nhuan_chua_phan_phoi': data.get_account_balance(['421']),\n            }\n        }\n    }\n```\n\n### 1.2. Báo Cáo Kết Quả Kinh Doanh (Mẫu B02-DN)\n```python\nfrom django_ledger.io.io_generator import IncomeStatementGenerator\n\ndef xuat_bao_cao_kqkd(entity_model, start_date, end_date):\n    \"\"\"\n    Xuất báo cáo kết quả kinh doanh theo mẫu B02-DN\n    \"\"\"\n    generator = IncomeStatementGenerator(\n        entity_slug=entity_model.slug,\n        from_date=start_date,\n        to_date=end_date\n    )\n    \n    data = generator.get_income_statement_data()\n    \n    return {\n        'doanh_thu': {\n            'doanh_thu_ban_hang': data.get_account_balance(['511']),\n            'cac_khoan_giam_tru': data.get_account_balance(['521']),\n            'doanh_thu_thuan': data.get_account_balance(['511']) - \n                              data.get_account_balance(['521'])\n        },\n        'chi_phi': {\n            'gia_von_hang_ban': data.get_account_balance(['632']),\n            'chi_phi_ban_hang': data.get_account_balance(['641']),\n            'chi_phi_quan_ly': data.get_account_balance(['642'])\n        },\n        'loi_nhuan': {\n            'loi_nhuan_gop': data.get_gross_profit(),\n            'loi_nhuan_truoc_thue': data.get_earnings_before_tax(),\n            'loi_nhuan_sau_thue': data.get_net_income()\n        }\n    }\n```\n\n### 1.3. Báo Cáo Lưu Chuyển Tiền Tệ (Mẫu B03-DN)\n```python\nfrom django_ledger.io.io_generator import CashFlowStatementGenerator\n\ndef xuat_bao_cao_lctt(entity_model, start_date, end_date):\n    \"\"\"\n    Xuất báo cáo lưu chuyển tiền tệ theo mẫu B03-DN\n    \"\"\"\n    generator = CashFlowStatementGenerator(\n        entity_slug=entity_model.slug,\n        from_date=start_date,\n        to_date=end_date\n    )\n    \n    data = generator.get_cash_flow_statement()\n    \n    return {\n        'lctt_hoat_dong_kinh_doanh': {\n            'thu_tu_ban_hang': data.get_cash_receipts_from_customers(),\n            'chi_tra_nguoi_ban': data.get_payments_to_suppliers(),\n            'chi_tra_nguoi_lao_dong': data.get_payments_to_employees(),\n            'thue_tndn_da_nop': data.get_income_tax_paid()\n        },\n        'lctt_hoat_dong_dau_tu': {\n            'chi_mua_sam_tscd': data.get_capital_expenditures(),\n            'thu_tu_thanh_ly_tscd': data.get_proceeds_from_asset_sales()\n        },\n        'lctt_hoat_dong_tai_chinh': {\n            'thu_tu_di_vay': data.get_proceeds_from_borrowings(),\n            'tra_no_goc_vay': data.get_debt_principal_payments()\n        }\n    }\n```\n\n## 2. Báo Cáo Thuế\n\n### 2.1. Tờ Khai Thuế GTGT (Mẫu 01/GTGT)\n```python\ndef lap_to_khai_thue_gtgt(entity_model, period_month, period_year):\n    \"\"\"\n    Lập tờ khai thuế GTGT theo tháng\n    \"\"\"\n    # Tính thuế GTGT đầu ra\n    thue_gtgt_dau_ra = TransactionModel.objects.filter(\n        journal_entry__ledger__entity=entity_model,\n        account_id='33311',\n        journal_entry__date__month=period_month,\n        journal_entry__date__year=period_year\n    ).aggregate(total=Sum('amount'))['total'] or 0\n    \n    # Tính thuế GTGT đầu vào được khấu trừ\n    thue_gtgt_dau_vao = TransactionModel.objects.filter(\n        journal_entry__ledger__entity=entity_model,\n        account_id='1331',\n        journal_entry__date__month=period_month,\n        journal_entry__date__year=period_year\n    ).aggregate(total=Sum('amount'))['total'] or 0\n    \n    return {\n        'thue_gtgt_dau_ra': thue_gtgt_dau_ra,\n        'thue_gtgt_dau_vao': thue_gtgt_dau_vao,\n        'thue_gtgt_phai_nop': thue_gtgt_dau_ra - thue_gtgt_dau_vao\n    }\n```\n\n### 2.2. Tờ Khai Thuế TNDN Tạm Tính (Mẫu 01A/TNDN)\n```python\ndef lap_to_khai_thue_tndn_tam_tinh(entity_model, quarter, year):\n    \"\"\"\n    Lập tờ khai thuế TNDN tạm tính theo quý\n    \"\"\"\n    # Tính tổng doanh thu\n    doanh_thu = TransactionModel.objects.filter(\n        journal_entry__ledger__entity=entity_model,\n        account_id__startswith='511',\n        journal_entry__date__year=year,\n        journal_entry__date__quarter=quarter\n    ).aggregate(total=Sum('amount'))['total'] or 0\n    \n    # Tính tổng chi phí\n    chi_phi = TransactionModel.objects.filter(\n        journal_entry__ledger__entity=entity_model,\n        account_id__startswith='6',\n        journal_entry__date__year=year,\n        journal_entry__date__quarter=quarter\n    ).aggregate(total=Sum('amount'))['total'] or 0\n    \n    loi_nhuan = doanh_thu - chi_phi\n    thue_suat = Decimal('0.20')  # 20%\n    \n    return {\n        'tong_doanh_thu': doanh_thu,\n        'tong_chi_phi': chi_phi,\n        'loi_nhuan_truoc_thue': loi_nhuan,\n        'thue_tndn_tam_tinh': loi_nhuan * thue_suat\n    }\n```\n\n### 2.3. Tờ Khai Quyết Toán Thuế TNDN (Mẫu 03/TNDN)\n```python\ndef lap_to_khai_quyet_toan_thue_tndn(entity_model, year):\n    \"\"\"\n    Lập tờ khai quyết toán thuế TNDN năm\n    \"\"\"\n    # Tính kết quả kinh doanh\n    doanh_thu = get_annual_revenue(entity_model, year)\n    chi_phi = get_annual_expenses(entity_model, year)\n    loi_nhuan_ke_toan = doanh_thu - chi_phi\n    \n    # Xác định các khoản điều chỉnh\n    dieu_chinh_tang = get_increasing_adjustments(entity_model, year)\n    dieu_chinh_giam = get_decreasing_adjustments(entity_model, year)\n    \n    # Tính thu nhập chịu thuế\n    thu_nhap_chiu_thue = loi_nhuan_ke_toan + dieu_chinh_tang - dieu_chinh_giam\n    \n    # Tính thuế TNDN\n    thue_suat = Decimal('0.20')\n    thue_tndn = thu_nhap_chiu_thue * thue_suat\n    \n    return {\n        'ket_qua_kinh_doanh': {\n            'doanh_thu': doanh_thu,\n            'chi_phi': chi_phi,\n            'loi_nhuan_ke_toan': loi_nhuan_ke_toan\n        },\n        'xac_dinh_thu_nhap_chiu_thue': {\n            'loi_nhuan_ke_toan': loi_nhuan_ke_toan,\n            'dieu_chinh_tang': dieu_chinh_tang,\n            'dieu_chinh_giam': dieu_chinh_giam,\n            'thu_nhap_chiu_thue': thu_nhap_chiu_thue\n        },\n        'tinh_thue_tndn': {\n            'thu_nhap_chiu_thue': thu_nhap_chiu_thue,\n            'thue_suat': thue_suat,\n            'thue_tndn_phai_nop': thue_tndn\n        }\n    }\n```\n\n## 3. Báo Cáo Phân Tích\n\n### 3.1. Phân Tích Tài Chính\n```python\ndef phan_tich_tai_chinh(entity_model, report_date):\n    \"\"\"\n    Phân tích các chỉ số tài chính cơ bản\n    \"\"\"\n    calculator = FinancialRatioCalculator(\n        entity_model=entity_model,\n        report_date=report_date\n    )\n    \n    return {\n        'kha_nang_thanh_toan': {\n            'ty_so_thanh_toan_hien_hanh': calculator.current_ratio(),\n            'ty_so_thanh_toan_nhanh': calculator.quick_ratio()\n        },\n        'hieu_qua_hoat_dong': {\n            'vong_quay_hang_ton_kho': calculator.inventory_turnover(),\n            'ky_thu_tien_trung_binh': calculator.average_collection_period()\n        },\n        'kha_nang_sinh_loi': {\n            'ty_suat_loi_nhuan_gop': calculator.gross_profit_margin(),\n            'ty_suat_loi_nhuan_rong': calculator.net_profit_margin(),\n            'ROE': calculator.return_on_equity(),\n            'ROA': calculator.return_on_assets()\n        }\n    }\n```\n\n### 3.2. Phân Tích Chi Phí\n```python\ndef phan_tich_chi_phi(entity_model, start_date, end_date):\n    \"\"\"\n    Phân tích cơ cấu chi phí\n    \"\"\"\n    total_expenses = get_total_expenses(entity_model, start_date, end_date)\n    \n    return {\n        'chi_phi_san_xuat': {\n            'nguyen_lieu': get_expense_percentage('621', total_expenses),\n            'nhan_cong': get_expense_percentage('622', total_expenses),\n            'san_xuat_chung': get_expense_percentage('627', total_expenses)\n        },\n        'chi_phi_ban_hang': {\n            'nhan_vien': get_expense_percentage('6411', total_expenses),\n            'vat_lieu': get_expense_percentage('6412', total_expenses),\n            'dich_vu_mua_ngoai': get_expense_percentage('6417', total_expenses)\n        },\n        'chi_phi_quan_ly': {\n            'nhan_vien': get_expense_percentage('6421', total_expenses),\n            'khau_hao': get_expense_percentage('6424', total_expenses),\n            'dich_vu': get_expense_percentage('6427', total_expenses)\n        }\n    }\n```\n\n## 4. Xuất Báo Cáo\n\n### 4.1. Xuất Excel\n```python\ndef xuat_bao_cao_excel(entity_model, report_type, start_date, end_date):\n    \"\"\"\n    Xuất báo cáo ra file Excel\n    \"\"\"\n    import pandas as pd\n    \n    if report_type == 'balance_sheet':\n        data = xuat_bang_can_doi_ke_toan(entity_model, end_date)\n    elif report_type == 'income_statement':\n        data = xuat_bao_cao_kqkd(entity_model, start_date, end_date)\n    elif report_type == 'cash_flow':\n        data = xuat_bao_cao_lctt(entity_model, start_date, end_date)\n        \n    df = pd.DataFrame(data)\n    return df.to_excel()\n\n# API Endpoint\n\"\"\"\nGET /api/entity/{entity_slug}/reports/excel/\nParameters:\n- report_type: string\n- from_date: YYYY-MM-DD\n- to_date: YYYY-MM-DD\n\"\"\"\n```\n\n### 4.2. Xuất PDF\n```python\ndef xuat_bao_cao_pdf(entity_model, report_type, template_name, context):\n    \"\"\"\n    Xuất báo cáo ra file PDF sử dụng template\n    \"\"\"\n    from django.template.loader import render_to_string\n    from weasyprint import HTML\n    \n    # Render template\n    html_string = render_to_string(template_name, context)\n    \n    # Tạo PDF\n    html = HTML(string=html_string)\n    pdf = html.write_pdf()\n    \n    return pdf\n\n# API Endpoint\n\"\"\"\nGET /api/entity/{entity_slug}/reports/pdf/\nParameters:\n- report_type: string\n- from_date: YYYY-MM-DD\n- to_date: YYYY-MM-DD\n\"\"\"\n```\n\n## 5. Hệ Thống Cảnh Báo\n\n### 5.1. Cảnh Báo Thuế\n```python\ndef canh_bao_thue(entity_model):\n    \"\"\"\n    Kiểm tra và cảnh báo các vấn đề về thuế\n    \"\"\"\n    warnings = []\n    \n    # Kiểm tra thuế GTGT\n    vat_balance = get_vat_balance(entity_model)\n    if vat_balance \u003e 0:\n        warnings.append({\n            'type': 'VAT_DUE',\n            'message': f'Có {vat_balance:,.2f} VND thuế GTGT cần nộp',\n            'deadline': get_vat_deadline()\n        })\n    \n    # Kiểm tra thuế TNDN\n    cit_balance = get_cit_balance(entity_model)\n    if cit_balance \u003e 0:\n        warnings.append({\n            'type': 'CIT_DUE',\n            'message': f'Có {cit_balance:,.2f} VND thuế TNDN cần nộp',\n            'deadline': get_cit_deadline()\n        })\n    \n    return warnings\n```\n\n### 5.2. Cảnh Báo Tài Chính\n```python\ndef canh_bao_tai_chinh(entity_model):\n    \"\"\"\n    Kiểm tra và cảnh báo các vấn đề về tài chính\n    \"\"\"\n    warnings = []\n    \n    # Kiểm tra tỷ lệ thanh toán\n    current_ratio = calculate_current_ratio(entity_model)\n    if current_ratio \u003c 1:\n        warnings.append({\n            'type': 'LOW_LIQUIDITY',\n            'message': 'Tỷ lệ thanh toán thấp',\n            'value': current_ratio\n        })\n    \n    # Kiểm tra công nợ quá hạn\n    overdue_receivables = get_overdue_receivables(entity_model)\n    if overdue_receivables:\n        warnings.append({\n            'type': 'OVERDUE_RECEIVABLES',\n            'message': 'Có công nợ quá hạn cần thu hồi',\n            'items': overdue_receivables\n        })\n    \n    return warnings\n"])</script><script>self.__next_f.push([1,"9:[\"slug\",\"erp/reports_and_tax\",\"c\"]\nf:[]\n"])</script><script>self.__next_f.push([1,"0:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/erp-docs/_next/static/css/4b73dfd0f7bdc629.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]],[\"$\",\"$L3\",null,{\"buildId\":\"X5KF-BjlTdL2YCafX7ACW\",\"assetPrefix\":\"/erp-docs\",\"initialCanonicalUrl\":\"/erp/reports_and_tax/\",\"initialTree\":[\"\",{\"children\":[[\"slug\",\"erp/reports_and_tax\",\"c\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":[\\\"erp\\\",\\\"reports_and_tax\\\"]}\",{}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[[\"slug\",\"erp/reports_and_tax\",\"c\"],{\"children\":[\"__PAGE__\",{},[[\"$L4\",[\"$\",\"$L5\",null,{\"children\":[\"$\",\"article\",null,{\"className\":\"prose prose-slate dark:prose-invert max-w-none\",\"children\":[[\"$\",\"header\",null,{\"className\":\"mb-8\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"mb-2\",\"children\":\"$undefined\"}],\"$undefined\",\"$undefined\"]}],[\"$\",\"$L6\",null,{\"content\":\"$7\"}]]}]}]],null],null]},[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"$9\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}],null]},[[\"$\",\"html\",null,{\"lang\":\"en\",\"suppressHydrationWarning\":true,\"children\":[\"$\",\"body\",null,{\"className\":\"__className_985585\",\"children\":[\"$\",\"$Lb\",null,{\"attribute\":\"class\",\"defaultTheme\":\"system\",\"enableSystem\":true,\"disableTransitionOnChange\":true,\"children\":[\"$\",\"$Lc\",null,{\"children\":[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[],\"styles\":null}]}]}]}]}],null],null],\"couldBeIntercepted\":false,\"initialHead\":[false,\"$Ld\"],\"globalErrorComponent\":\"$e\",\"missingSlots\":\"$Wf\"}]]\n"])</script><script>self.__next_f.push([1,"d:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"undefined | ERP Documentation\"}],[\"$\",\"meta\",\"3\",{\"name\":\"keywords\",\"content\":\"documentation,ERP,technical,mermaid,markdown\"}],[\"$\",\"meta\",\"4\",{\"name\":\"next-size-adjust\"}]]\n4:null\n"])</script></body></html>